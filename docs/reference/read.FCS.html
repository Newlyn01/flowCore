<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read an FCS file — read.FCS • flowCore</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Read an FCS file — read.FCS" />
<meta property="og:description" content="Check validity and Read Data File Standard for Flow Cytometry" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flowCore</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.99.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read an FCS file</h1>
    
    <div class="hidden name"><code>read.FCS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Check validity and Read Data File Standard for Flow Cytometry</p>
    </div>

    <pre class="usage"><span class='fu'>isFCSfile</span>(<span class='no'>files</span>)

<span class='fu'>read.FCS</span>(<span class='no'>filename</span>, <span class='kw'>transformation</span><span class='kw'>=</span><span class='st'>"linearize"</span>, <span class='kw'>which.lines</span><span class='kw'>=</span><span class='kw'>NULL</span>,
         <span class='kw'>alter.names</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>column.pattern</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>invert.pattern</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
         <span class='kw'>decades</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>ncdf</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>min.limit</span><span class='kw'>=</span><span class='kw'>NULL</span>,
         <span class='kw'>truncate_max_range</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>dataset</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>emptyValue</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
         <span class='kw'>channel_alias</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>filename</th>
      <td><p>Character of length 1: filename</p></td>
    </tr>
    <tr>
      <th>transformation</th>
      <td><p>An character string that defines the type of
transformation. Valid values are <code>linearize</code> (default),
<code>linearize-with-PnG-scaling</code>, or <code>scale</code>.  The <code>linearize</code>
transformation applies the appropriate power transform to the data. The
<code>linearize-with-PnG-scaling</code> transformation applies the appropriate
power transform for parameters stored on log scale, and also a linear
scaling transformation based on the 'gain' (FCS \$PnG keywords) for
parameters stored on a linear scale. The <code>scale</code> transformation scales
all columns to $[0,10^decades]$.  defaulting to decades=0 as in the FCS4
specification.  A logical can also be used: <code>TRUE</code> is equal to
<code>linearize</code> and <code>FALSE</code>(or <code>NULL</code>) corresponds to no
transformation.  Also when the transformation keyword of the FCS header is
set to "custom" or "applied", no transformation will be used.</p></td>
    </tr>
    <tr>
      <th>which.lines</th>
      <td><p>Numeric vector to specify the indices of the lines to be
read. If NULL all the records are read, if of length 1, a random sample of
the size indicated by <code>which.lines</code> is read in. It's used to achieve partial disk IO
for the large FCS that can't fit the full data into memory. Be aware the potential slow read
(especially for the large size of random sampling) due to the frequent disk seek operations.</p></td>
    </tr>
    <tr>
      <th>alter.names</th>
      <td><p>boolean indicating whether or not we should rename the
columns to valid R names using <code><a href='https://rdrr.io/r/base/make.names.html'>make.names</a></code>. The default is
FALSE.</p></td>
    </tr>
    <tr>
      <th>column.pattern</th>
      <td><p>An optional regular expression defining parameters we
should keep when loading the file. The default is NULL.</p></td>
    </tr>
    <tr>
      <th>invert.pattern</th>
      <td><p>logical. By default, <code>FALSE</code>. If <code>TRUE</code>,
inverts the regular expression specified in <code>column.pattern</code>. This is
useful for indicating the channel names that we do not want to read. If
<code>column.pattern</code> is set to <code>NULL</code>, this argument is ignored.</p></td>
    </tr>
    <tr>
      <th>decades</th>
      <td><p>When scaling is activated, the number of decades to use for
the output.</p></td>
    </tr>
    <tr>
      <th>ncdf</th>
      <td><p>Deprecated. Please use 'ncdfFlow' package for cdf based storage.</p></td>
    </tr>
    <tr>
      <th>min.limit</th>
      <td><p>The minimum value in the data range that is allowed. Some
instruments produce extreme artifactual values. The positive data range for
each parameter is completely defined by the measurement range of the
instrument and all larger values are set to this threshold. The lower data
boundary is not that well defined, since compensation might shift some
values below the original measurement range of the instrument. This can be 
set to an arbitrary number or to <code>NULL</code> (the default value), in which 
case the original values are kept. When the transformation keyword of the FCS header is
set (typically to "custom" or "applied"), no shift up to min.limit will occur.</p></td>
    </tr>
    <tr>
      <th>truncate_max_range</th>
      <td><p>logical type. Default is TRUE. can be optionally
turned off to avoid truncating the extreme positive value to the instrument
measurement range .i.e.'$PnR'. When the transformation keyword of the FCS header is
set (typically to "custom" or "applied"), no truncation will occur.</p></td>
    </tr>
    <tr>
      <th>dataset</th>
      <td><p>The FCS file specification allows for multiple data segments
in a single file. Since the output of <code>read.FCS</code> is a single
<code>flowFrame</code> we can't automatically read in all available sets. This
parameter allows to chose one of the subsets for import. Its value is
supposed to be an integer in the range of available data sets. This argument
is ignored if there is only a single data segment in the FCS file.</p></td>
    </tr>
    <tr>
      <th>emptyValue</th>
      <td><p>boolean indicating whether or not we allow empty value for
keyword values in TEXT segment.  It affects how the double delimiters are
treated.  IF TRUE, The double delimiters are parsed as a pair of start and
end single delimiter for an empty value.  Otherwise, double delimiters are
parsed one part of string as the keyword value.  default is TRUE.</p></td>
    </tr>
    <tr>
      <th>channel_alias</th>
      <td><p>an optional data.frame used to provide the alias of the channels
to standardize and solve the discrepancy across FCS files. It is expected to
contain 'alias' and 'channels' column of 'channel_alias'. Each row/entry specifies the common
alias name for a collection of channels (comma separated). See examples for
details.</p>
<p>For each channel in the FCS file, read.FCS will first attempt
to find an exact match in the 'channels' column. If no exact match is found,
it will check for partial matches. That is, if "V545" is in the 'channels'
column of 'channel_alias' and "V545-A" is present in the FCS file, this
partial match will allow the corresponding 'alias' to be assigned. This partial
matching only works in this direction ("V545-A" in the 'channels' column will
not match "V545" in the FCS file) and care should be exercised to ensure no unintended
partial matching of other channel names. If no exact or partial match is found, 
the channel is unchanged in the resulting <code>flowFrame</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>ignore.text.offset: whether to ignore the keyword values in TEXT
segment when they don't agree with the HEADER.  Default is FALSE, which
throws the error when such discrepancy is found.  User can turn it on to
ignore TEXT segment when he is sure of the accuracy of HEADER so that the
file still can be read.</p></td>
    </tr>
    <tr>
      <th>files</th>
      <td><p>A vector of filenames</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>isFCSfile</code> returns a logical vector.</p>
<p><code>read.FCS</code> returns an object of class
<code><a href='flowFrame-class.html'>flowFrame</a></code> that contains the data in
the <code>exprs</code> slot, the parameters monitored in the <code>parameters</code>
slot and the keywords and value saved in the header of the FCS file.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function <code>isFCSfile</code> determines whether its arguments are valid FCS
files.</p>
<p>The function <code>read.FCS</code> works with the output of the FACS machine
software from a number of vendors (FCS 2.0, FCS 3.0 and List Mode Data LMD).
However, the FCS 3.0 standard includes some options that are not yet
implemented in this function. If you need extensions, please let me know.
The output of the function is an object of class <code>flowFrame</code>.</p>
<p>For specifications of FCS 3.0 see <a href='http://www.isac-net.org'>http://www.isac-net.org</a> and the file
<a href='../doc/fcs3.html'>../doc/fcs3.html</a> in the <code>doc</code> directory of the package.</p>
<p>The <code>which.lines</code> arguments allow you to read a subset of the record as
you might not want to read the thousands of events recorded in the FCS file.
It is mainly used when there is not enough memory to read one single FCS
(which probably will not happen).  It will probably take more time than
reading the entire FCS (due to the multiple disk IO).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='read.flowSet.html'>read.flowSet</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## a sample file</span>
<span class='no'>fcsFile</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"0877408774.B08"</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"flowCore"</span>)

<span class='co'>## read file and linearize values</span>
<span class='no'>samp</span> <span class='kw'>&lt;-</span>  <span class='fu'>read.FCS</span>(<span class='no'>fcsFile</span>, <span class='kw'>transformation</span><span class='kw'>=</span><span class='st'>"linearize"</span>)
<span class='fu'><a href='flowFrame-class.html'>exprs</a></span>(<span class='no'>samp</span>[<span class='fl'>1</span>:<span class='fl'>3</span>,])</div><div class='output co'>#&gt;      FSC-H SSC-H      FL1-H    FL2-H     FL3-H FL1-A     FL4-H Time
#&gt; [1,]   382    77 259.455272  1.00000  7.566695    55  13.09747    1
#&gt; [2,]   628   280   9.057978 48.26071 10.273508     0  28.13318    1
#&gt; [3,]  1023   735 537.611747 56.23413  6.915821   143 310.59002    1</div><div class='input'><span class='fu'><a href='keyword-methods.html'>keyword</a></span>(<span class='no'>samp</span>)[<span class='fl'>3</span>:<span class='fl'>6</span>]</div><div class='output co'>#&gt; $`$DATATYPE`
#&gt; [1] "F"
#&gt; 
#&gt; $`$NEXTDATA`
#&gt; [1] "0"
#&gt; 
#&gt; $`$SYS`
#&gt; [1] "Macintosh System Software 9.2.2"
#&gt; 
#&gt; $CREATOR
#&gt; [1] "CELLQuest&lt;aa&gt; 3.3"
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span>(<span class='no'>samp</span>)</div><div class='output co'>#&gt; [1] "flowFrame"
#&gt; attr(,"package")
#&gt; [1] "flowCore"</div><div class='input'>
<span class='co'>## Only read in lines 2 to 5</span>
<span class='no'>subset</span> <span class='kw'>&lt;-</span> <span class='fu'>read.FCS</span>(<span class='no'>fcsFile</span>, <span class='kw'>which.lines</span><span class='kw'>=</span><span class='fl'>2</span>:<span class='fl'>5</span>, <span class='kw'>transformation</span><span class='kw'>=</span><span class='st'>"linearize"</span>)
<span class='fu'><a href='flowFrame-class.html'>exprs</a></span>(<span class='no'>subset</span>)</div><div class='output co'>#&gt;      FSC-H SSC-H      FL1-H     FL2-H     FL3-H FL1-A       FL4-H Time
#&gt; [1,]   628   280   9.057978  48.26071 10.273508     0   28.133175    1
#&gt; [2,]  1023   735 537.611747  56.23413  6.915821   143  310.590022    1
#&gt; [3,]   373   128   6.152654  24.14418  2.329097     0    3.819718    1
#&gt; [4,]  1023  1023 259.455272 791.47554 39.241898    61 2414.418221    1
#&gt; attr(,"ranges")
#&gt; [1]  1023  1023 10000 10000 10000  1023 10000  1023</div><div class='input'>
<span class='co'>## Read in a random sample of 100 lines</span>
<span class='no'>subset</span> <span class='kw'>&lt;-</span> <span class='fu'>read.FCS</span>(<span class='no'>fcsFile</span>, <span class='kw'>which.lines</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>transformation</span><span class='kw'>=</span><span class='st'>"linearize"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>subset</span>)</div><div class='output co'>#&gt; [1] 100</div><div class='input'>
<span class='co'>#manually supply the alias vs channel options mapping as a data.frame</span>
<span class='no'>map</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>alias</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>)
                  , <span class='kw'>channels</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"FL2"</span>, <span class='st'>"FL4"</span>)
)
<span class='no'>fr</span> <span class='kw'>&lt;-</span> <span class='fu'>read.FCS</span>(<span class='no'>fcsFile</span>, <span class='kw'>channel_alias</span> <span class='kw'>=</span> <span class='no'>map</span>)
<span class='no'>fr</span></div><div class='output co'>#&gt; flowFrame object '0877408774.B08'
#&gt; with 10000 cells and 8 observables:
#&gt;      name              desc range minRange maxRange
#&gt; $P1 FSC-H             FSC-H  1024 0.000000     1023
#&gt; $P2 SSC-H             SSC-H  1024 0.000000     1023
#&gt; $P3 FL1-H              &lt;NA&gt;  1024 1.009044    10000
#&gt; $P4     A              &lt;NA&gt;  1024 1.009044    10000
#&gt; $P5 FL3-H              &lt;NA&gt;  1024 1.009044    10000
#&gt; $P6 FL1-A              &lt;NA&gt;  1024 0.000000     1023
#&gt; $P7     B              &lt;NA&gt;  1024 1.009044    10000
#&gt; $P8  Time Time (51.20 sec.)  1024 0.000000     1023
#&gt; 164 keywords are stored in the 'description' slot</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by B Ellis, Perry Haaland, Florian Hahne, Nolwenn Le Meur, Nishant Gopalakrishnan, Josef Spidlen, Mike Jiang, Greg Finak.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


